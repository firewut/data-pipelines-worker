{
    "slug": "openai-test",
    "title": "Youtube video generation pipeline from prompt",
    "description": "Generates videos for youtube Channel <CHANNEL>. Uses Prompt in the Block.",
    "blocks": [
        {
            "id": "openai_chat_completion",
            "slug": "get-event-text",
            "description": "Get a text from OpenAI Chat Completion API",
            "input": {
                "model": "gpt-4o-2024-08-06",
                "system_prompt": "You must look for Historical event ( use google ) which happened today years ago. Write a short story about it. Add some interesting facts and make it engaging. The story MUST BE 30 words long!!!!!!!!",
                "user_prompt": "What happened years ago at date October 23 ?"
            }
        },
        {
            "id": "send_moderation_telegram",
            "slug": "send-event-text-moderation-to-telegram",
            "description": "Send the Event Text to Telegram for moderation",
            "input_config": {
                "property": {
                    "text": {
                        "origin": "get-event-text",
                        "json_path": "$"
                    }
                }
            },
            "input": {
                "group_id": -4573786981,
                "extra_decisions": {
                    "Regenerate": "Refresh"
                },
                "regenerate_block_slug": "get-event-text"
            }
        },
        {
            "id": "fetch_moderation_telegram",
            "slug": "fetch-event-text-moderation-from-telegram",
            "description": "Fetch the Event Text moderation decision from Telegram",
            "input": {
                "block_slug": "send-event-text-moderation-to-telegram"
            }
        },
        {
            "id": "openai_tts_request",
            "slug": "get-event-tts",
            "description": "Make a request to OpenAI TTS API to convert text to speech",
            "input_config": {
                "property": {
                    "text": {
                        "origin": "get-event-text",
                        "json_path": "$"
                    }
                }
            }
        },
        {
            "id": "openai_transcription_request",
            "slug": "get-event-transcription",
            "description": "Make a request to OpenAI TTS API to convert text to speech",
            "input_config": {
                "property": {
                    "audio_file": {
                        "origin": "get-event-tts"
                    }
                }
            }
        },
        {
            "id": "wrap_text",
            "slug": "make-system-prompt-for-image-prompt-generation",
            "description": "Make a system prompt for image generation from the event text",
            "input_config": {
                "property": {
                    "text": {
                        "origin": "get-event-transcription",
                        "json_path": "$.text"
                    }
                }
            },
            "input": {
                "prefix": "You are going to create a prompt to generate an image according to this text and user request: "
            }
        },
        {
            "id": "openai_chat_completion",
            "slug": "get-prompt-for-image-generation-text",
            "description": "Get prompts for image generation from OpenAI Chat Completion",
            "input_config": {
                "type": "array",
                "property": {
                    "system_prompt": {
                        "origin": "make-system-prompt-for-image-prompt-generation"
                    },
                    "user_prompt": {
                        "origin": "get-event-transcription",
                        "json_path": "$.segments[*].text"
                    }
                }
            },
            "input": {
                "model": "gpt-4o-2024-08-06"
            }
        },
        {
            "id": "openai_image_request",
            "slug": "get-event-images",
            "description": "Make a request to OpenAI Image API to get an image",
            "input_config": {
                "type": "array",
                "property": {
                    "prompt": {
                        "origin": "get-prompt-for-image-generation-text"
                    }
                }
            },
            "input": {
                "quality": "hd",
                "size": "1024x1792"
            }
        },
        {
            "id": "send_moderation_telegram",
            "slug": "send-event-images-moderation-to-telegram",
            "description": "Send generated Event Images to Telegram for moderation",
            "input_config": {
                "type": "array",
                "parallel": true,
                "property": {
                    "image": {
                        "origin": "get-event-images"
                    },
                    "text": {
                        "origin": "get-event-transcription",
                        "json_path": "$.segments[*].text"
                    }
                }
            },
            "input": {
                "group_id": -4573786981,
                "extra_decisions": {
                    "Regenerate": "Refresh"
                },
                "regenerate_block_slug": "get-event-images"
            }
        },
        {
            "id": "fetch_moderation_telegram",
            "slug": "fetch-event-images-moderation-from-telegram",
            "description": "Fetch the moderation Image decision from Telegram",
            "input_config": {
                "type": "array",
                "parallel": true,
                "property": {
                    "hack_for_array_trigger": {
                        "origin": "send-event-images-moderation-to-telegram"
                    }
                }
            },
            "input": {
                "block_slug": "send-event-images-moderation-to-telegram"
            }
        },
        {
            "id": "image_add_text",
            "slug": "add-text-to-event-images",
            "description": "Add text to the generated Event Images",
            "input_config": {
                "type": "array",
                "parallel": true,
                "property": {
                    "image": {
                        "origin": "get-event-images"
                    },
                    "text": {
                        "origin": "get-event-transcription",
                        "json_path": "$.segments[*].text"
                    }
                }
            },
            "input": {
                "font_color": "#fff",
                "text_bg_margin": 25
            }
        },
        {
            "id": "video_from_image",
            "slug": "generate-videos-from-images-and-transcriptions",
            "description": "Generate video from Images and Transcription Segments",
            "input_config": {
                "type": "array", 
                "parallel": true,
                "property": {
                    "start": {
                        "origin": "get-event-transcription",
                        "json_path": "$.segments[*].start"
                    },
                    "end": {
                        "origin": "get-event-transcription",
                        "json_path": "$.segments[*].end"
                    },
                    "image": {
                        "origin": "add-text-to-event-images"
                    }
                }
            }
        }
    ]
}